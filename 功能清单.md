# 密码保险箱 - 功能完成清单

## 📊 项目概览

**项目名称：** Password Vault（密码保险箱）
**目标：** 完全复刻 1Password 功能的密码管理工具
**技术栈：** React + Vite + Node.js + Express + SQLite
**仓库地址：** https://github.com/LhhMiracle/passworddem

---

## ✅ 已完成功能

### 核心功能
- [x] 用户注册/登录系统
- [x] 端到端加密（AES-256-GCM）
- [x] 主密码派生密钥（PBKDF2，100,000次迭代）
- [x] 密码保险箱 CRUD 操作
- [x] 分类管理
  - 登录账号
  - 银行卡
  - WiFi 密码
  - 安全笔记
  - 其他
- [x] 搜索功能
- [x] PWA 支持（渐进式 Web 应用）
- [x] 离线缓存
- [x] 数据同步机制
- [x] **导入/导出功能**
  - 加密数据导出为 JSON
  - 支持合并导入模式
  - 支持替换导入模式
  - 数据完整性验证

### 阶段一功能（✅ 已完成）
- [x] **密码生成器增强**
  - 可配置密码长度（8-64位）
  - 字符类型选择（大写、小写、数字、特殊符号）
  - 密码强度实时评分（熵值计算）
  - 生成历史记录（最近10条）
  - 一键复制并自动填充
  - 避免易混淆字符选项（如 0/O, 1/l/I）
- [x] **标签系统**
  - 为密码条目添加多个标签
  - 标签管理（创建、编辑、删除）
  - 按标签筛选密码
  - 8种预设颜色自定义
- [x] **收藏夹功能**
  - 星标常用密码
  - 收藏列表独立展示
  - 收藏数量统计
- [x] **会话管理增强**
  - 自动锁定设置（5/10/15/30分钟/从不）
  - 锁定快捷键（Cmd/Ctrl + Shift + L）
  - 锁定前倒计时提醒（30秒）
  - 页面切换时自动锁定

### 阶段二功能（✅ 已完成）
- [x] **密码健康报告**
  - 检测重复密码
  - 检测弱密码（强度评分）
  - 检测旧密码（超过90天）
  - 安全评分仪表盘（0-100分）
  - 改进建议
- [x] **密码泄露检测**
  - 集成 Have I Been Pwned API
  - k-anonymity 模型（隐私保护）
  - 批量检测所有密码
  - 泄露警告提示
- [x] **双因素认证（2FA）**
  - TOTP 支持（Google Authenticator 兼容）
  - 二维码生成
  - 备用恢复码（10个）
  - 2FA 设置界面
  - 登录时 2FA 验证
- [x] **生物识别解锁**
  - WebAuthn API 集成
  - Touch ID / Face ID 支持
  - 多设备管理
  - 生物识别设置界面

### 阶段三功能（✅ 已完成）
- [x] **密码共享**
  - 生成安全共享链接
  - 设置过期时间（1小时/1天/7天）
  - 查看次数限制（1次/5次/无限）
  - 密码保护共享链接
  - 共享记录追踪
  - 撤销共享链接
- [x] **附件支持**
  - 上传加密文件（身份证扫描件、护照照片、重要文档）
  - 文件大小限制（10MB）
  - 支持格式：PDF, PNG, JPG, JPEG
  - 文件预览功能（图片在线预览）
  - AES-256 加密存储

### 阶段四功能（✨ 最新完成）
- [x] **Chrome/Edge 浏览器扩展**
  - Manifest V3 配置
  - 自动检测登录表单（识别用户名和密码字段）
  - 一键填充用户名密码
  - 保存新密码提示
  - 密码生成器集成
  - 右键菜单快捷访问
  - 扩展图标显示匹配密码数量
  - 快捷键支持（Cmd/Ctrl + Shift + P 打开，Cmd/Ctrl + Shift + F 填充）

---

## 🎯 功能开发路线图

### 阶段 1: 用户体验提升（1-2周）

#### 1. 密码生成器增强 ⭐ 推荐优先
**目标：** 提供强大的密码生成工具

**功能点：**
- [ ] 可配置密码长度（8-64位）
- [ ] 字符类型选择
  - [ ] 大写字母（A-Z）
  - [ ] 小写字母（a-z）
  - [ ] 数字（0-9）
  - [ ] 特殊符号（!@#$%^&*）
- [ ] 密码强度实时评分
  - 弱（红色）：< 8位或单一字符类型
  - 中（黄色）：8-12位，2种字符类型
  - 强（绿色）：12位以上，3+种字符类型
- [ ] 生成历史记录（最近10条）
- [ ] 一键复制并自动填充到表单
- [ ] 避免易混淆字符选项（如 0/O, 1/l/I）

**技术实现：**
- 前端：新建 `PasswordGenerator.jsx` 组件
- 使用 `crypto.getRandomValues()` 生成随机密码
- 评分算法：熵值计算
- 预计工作量：2-3天

---

#### 2. 标签系统 ⭐ 推荐优先
**目标：** 更灵活的密码分类管理

**功能点：**
- [ ] 为密码条目添加多个标签
- [ ] 标签管理界面
  - [ ] 创建标签
  - [ ] 编辑标签（名称、颜色）
  - [ ] 删除标签（需确认）
- [ ] 按标签筛选密码
- [ ] 标签颜色自定义（8种预设颜色）
- [ ] 标签自动建议（基于网站域名）

**数据库改动：**
```sql
CREATE TABLE tags (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  user_id INTEGER NOT NULL,
  name TEXT NOT NULL,
  color TEXT DEFAULT '#3b82f6',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id)
);

CREATE TABLE item_tags (
  item_id INTEGER NOT NULL,
  tag_id INTEGER NOT NULL,
  PRIMARY KEY (item_id, tag_id),
  FOREIGN KEY (item_id) REFERENCES vault_items(id) ON DELETE CASCADE,
  FOREIGN KEY (tag_id) REFERENCES tags(id) ON DELETE CASCADE
);
```

**技术实现：**
- 后端：新增 `/api/tags` 路由
- 前端：新建 `TagManager.jsx` 组件
- 预计工作量：3-4天

---

#### 3. 收藏夹功能
**目标：** 快速访问常用密码

**功能点：**
- [ ] 星标常用密码
- [ ] 收藏列表独立展示
- [ ] 拖拽排序（可选）
- [ ] 收藏数量统计

**数据库改动：**
```sql
ALTER TABLE vault_items ADD COLUMN is_favorite INTEGER DEFAULT 0;
ALTER TABLE vault_items ADD COLUMN favorite_order INTEGER;
```

**预计工作量：** 1-2天

---

#### 4. 会话管理增强
**目标：** 提升安全性

**功能点：**
- [ ] 自动锁定设置
  - 5 分钟
  - 10 分钟
  - 15 分钟
  - 30 分钟
  - 从不
- [ ] 锁定快捷键（Cmd/Ctrl + Shift + L）
- [ ] 锁定前通知提醒（倒计时 10 秒）
- [ ] 系统休眠后自动锁定

**技术实现：**
- 使用 `idle-timer` 检测用户活动
- 使用 Visibility API 检测页面切换
- 预计工作量：2天

---

### 阶段 2: 安全功能强化（2-3周）

#### 5. 密码健康报告 ⭐ 高优先级
**目标：** 帮助用户维护密码安全

**功能点：**
- [ ] 检测重复密码
  - 标记使用相同密码的账号
  - 显示重复次数
- [ ] 检测弱密码
  - 少于 8 位
  - 无特殊字符
  - 常见密码（如 123456, password）
- [ ] 检测旧密码
  - 超过 90 天未更新
  - 建议更新提醒
- [ ] 安全评分仪表盘
  - 总体评分（0-100）
  - 风险分类统计
  - 改进建议

**技术实现：**
- 前端：新建 `SecurityDashboard.jsx` 页面
- 算法：密码强度评分 + 时间戳分析
- 预计工作量：3-4天

---

#### 6. 密码泄露检测
**目标：** 主动发现泄露风险

**功能点：**
- [ ] 集成 Have I Been Pwned API
- [ ] 批量检查所有密码
  - 使用 k-anonymity 模型（保护隐私）
  - 只发送密码 SHA-1 哈希的前 5 位
- [ ] 泄露警告提示
- [ ] 一键修改泄露密码

**API 集成：**
```javascript
// Have I Been Pwned API
https://api.pwnedpasswords.com/range/{hash_prefix}
```

**技术实现：**
- 后端代理 API 请求（避免 CORS）
- 前端显示检测结果
- 预计工作量：2-3天

---

#### 7. 双因素认证（2FA）
**目标：** 增强账号安全

**功能点：**
- [ ] TOTP 支持（Google Authenticator 兼容）
- [ ] 二维码生成
- [ ] 备用恢复码生成（10个）
- [ ] 2FA 开关设置
- [ ] 强制 2FA 选项（企业版）

**技术依赖：**
- `otplib` - TOTP 生成
- `qrcode` - 二维码生成

**预计工作量：** 3-4天

---

#### 8. 生物识别解锁
**目标：** 快速便捷访问

**功能点：**
- [ ] Web Authentication API 集成
- [ ] Touch ID / Face ID 支持
- [ ] Windows Hello 支持
- [ ] 生物识别开关设置
- [ ] 降级到密码认证

**技术实现：**
- 使用 WebAuthn API
- 存储公钥凭证
- 预计工作量：4-5天

---

### 阶段 3: 高级功能（✅ 已完成）

#### 9. 密码共享 ✅
**功能点：**
- [x] 生成安全共享链接
- [x] 设置过期时间（1小时/1天/7天）
- [x] 查看次数限制（1次/5次/无限）
- [x] 密码保护共享链接
- [x] 共享记录追踪
- [x] 撤销共享链接

---

#### 10. 附件支持 ✅
**功能点：**
- [x] 上传加密文件
  - 身份证扫描件
  - 护照照片
  - 重要文档
- [x] 文件大小限制（10MB）
- [x] 支持格式：PDF, PNG, JPG, JPEG
- [x] 文件预览功能
- [x] 加密存储（AES-256）

---

#### 11. 密码历史
**功能点：**
- [ ] 记录密码修改历史（最多 10 条）
- [ ] 查看旧密码
- [ ] 恢复到历史版本
- [ ] 历史记录时间线

**数据库改动：**
```sql
CREATE TABLE password_history (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  item_id INTEGER NOT NULL,
  encrypted_data TEXT NOT NULL,
  iv TEXT NOT NULL,
  changed_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (item_id) REFERENCES vault_items(id) ON DELETE CASCADE
);
```

**预计工作量：** 2-3天

---

### 阶段 4: 浏览器扩展（✅ 已完成）

#### 12. Chrome/Edge 扩展 ✅
**目标：** 自动填充密码

**功能点：**
- [x] 自动检测登录表单
  - 识别用户名字段
  - 识别密码字段
- [x] 一键填充用户名密码
- [x] 保存新密码提示
- [x] 密码生成器集成
- [x] 右键菜单快捷访问
- [x] 扩展图标显示密码数量
- [x] 快捷键支持（Cmd/Ctrl + Shift + P）

**技术栈：**
- Manifest V3
- Vanilla JavaScript
- Chrome Extension API

---

#### 13. Firefox 扩展 ✅
**功能点：**
- [x] 复用 Chrome 扩展代码
- [x] Firefox 特定 API 适配
- [x] WebExtensions API

---

### 阶段 5: 桌面应用（✅ 已完成）

#### 14. Electron 桌面版 ✅
**目标：** 原生桌面体验

**功能点：**
- [x] 复用 Web PWA 代码（90%+）
- [x] 平台支持
  - macOS 应用打包（.dmg）
  - Windows 应用打包（.exe）
  - Linux 应用打包（.AppImage）
- [x] 系统托盘常驻
  - 最小化到托盘
  - 托盘菜单（解锁/锁定/退出）
- [x] 全局快捷键
  - Cmd/Ctrl + Shift + P - 快速搜索
  - Cmd/Ctrl + Shift + L - 锁定
- [x] IPC通信机制
- [x] 窗口状态持久化
- [x] 单实例运行保护

**技术栈：**
- Electron 28
- Vite 5
- electron-builder（打包）
- electron-store（本地存储）

---

## 📈 开发优先级建议

### 立即开始（本周）
1. ⭐⭐⭐ **密码生成器增强** - 最常用功能，快速见效
2. ⭐⭐⭐ **标签系统** - 显著提升用户体验

### 短期目标（2-4周）
3. ⭐⭐ 密码健康报告 - 核心安全功能
4. ⭐⭐ 收藏夹功能 - 提升便利性
5. ⭐ 会话管理增强 - 安全性提升

### 中期目标（1-2个月）
6. 密码泄露检测
7. 双因素认证
8. 生物识别解锁

### 长期目标（3-6个月）
9. 浏览器扩展（Chrome/Firefox）
10. Electron 桌面版

---

## 🛠 技术债务 & 优化

### 性能优化
- [ ] 实现虚拟滚动（密码列表超过 100 条时）
- [ ] 图片懒加载
- [ ] 代码分割（React.lazy）
- [ ] Service Worker 缓存优化

### 测试覆盖
- [ ] 单元测试（Jest）
  - 加密/解密函数
  - API 接口
  - 工具函数
- [ ] E2E 测试（Playwright）
  - 用户注册/登录流程
  - 密码 CRUD 操作
  - 导入/导出功能

### 文档完善
- [ ] API 接口文档（Swagger）
- [ ] 用户使用手册
- [ ] 开发者贡献指南
- [ ] 安全白皮书

---

## 📝 版本规划

### v1.0.0（已发布）
- 基础密码管理功能
- 导入/导出功能

### v1.1.0（✅ 已完成）
- 密码生成器增强
- 标签系统
- 收藏夹功能
- 会话管理增强

### v1.2.0（✅ 已完成）
- 密码健康报告
- 密码泄露检测
- 双因素认证
- 生物识别解锁

### v2.0.0（已完成）
- 密码共享
- 附件支持

### v2.1.0（已完成）
- Chrome/Edge 浏览器扩展
- Firefox 浏览器扩展

### v3.0.0（✨ 最新完成）
- Electron 桌面应用

### v4.0.0（计划中）
- 密码历史记录
- iOS 应用
- Android 应用

---

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

### 开发流程
1. Fork 本仓库
2. 创建功能分支（`git checkout -b feature/amazing-feature`）
3. 提交更改（`git commit -m 'feat: add amazing feature'`）
4. 推送到分支（`git push origin feature/amazing-feature`）
5. 提交 Pull Request

### Commit 规范
遵循 [Conventional Commits](https://www.conventionalcommits.org/)：
- `feat:` 新功能
- `fix:` Bug 修复
- `docs:` 文档更新
- `style:` 代码格式
- `refactor:` 重构
- `test:` 测试
- `chore:` 构建/工具

---

## 📄 许可证

MIT License

---

**最后更新：** 2025-12-11
**维护者：** Haihui Lu (@LhhMiracle)
