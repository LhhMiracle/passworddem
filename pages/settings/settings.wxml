<!-- 设置页面 -->
<view class="settings-container">
  <scroll-view class="settings-scroll" scroll-y="{{true}}">
    <!-- 安全设置 -->
    <view class="settings-section">
      <view class="section-header">
        <text class="section-icon">&#128274;</text>
        <text class="section-title">安全设置</text>
      </view>

      <view class="settings-item" bindtap="changePassword">
        <view class="item-left">
          <text class="item-title">修改主密码</text>
          <text class="item-desc">定期更换密码更安全</text>
        </view>
        <text class="item-arrow">&#8250;</text>
      </view>

      <view class="settings-item">
        <view class="item-left">
          <text class="item-title">自动锁定</text>
          <text class="item-desc">离开应用后自动锁定</text>
        </view>
        <picker
          mode="selector"
          range="{{autoLockOptions}}"
          range-key="label"
          value="{{autoLockIndex}}"
          bindchange="onAutoLockChange"
        >
          <text class="item-value">{{autoLockOptions[autoLockIndex].label}}</text>
        </picker>
      </view>
    </view>

    <!-- 数据管理 -->
    <view class="settings-section">
      <view class="section-header">
        <text class="section-icon">&#128451;</text>
        <text class="section-title">数据管理</text>
      </view>

      <view class="settings-item">
        <view class="item-left">
          <text class="item-title">密码总数</text>
        </view>
        <text class="item-value">{{stats.total}} 个</text>
      </view>

      <view class="settings-item" wx:if="{{stats.weakPasswords > 0}}">
        <view class="item-left">
          <text class="item-title">弱密码警告</text>
          <text class="item-desc warning">发现 {{stats.weakPasswords}} 个弱密码</text>
        </view>
        <text class="item-arrow">&#8250;</text>
      </view>

      <view class="settings-item" bindtap="exportData">
        <view class="item-left">
          <text class="item-title">导出数据</text>
          <text class="item-desc">备份您的密码数据</text>
        </view>
        <text class="item-arrow">&#8250;</text>
      </view>

      <view class="settings-item" bindtap="importData">
        <view class="item-left">
          <text class="item-title">导入数据</text>
          <text class="item-desc">从备份恢复密码</text>
        </view>
        <text class="item-arrow">&#8250;</text>
      </view>
    </view>

    <!-- 关于 -->
    <view class="settings-section">
      <view class="section-header">
        <text class="section-icon">&#9432;</text>
        <text class="section-title">关于</text>
      </view>

      <view class="settings-item">
        <view class="item-left">
          <text class="item-title">版本</text>
        </view>
        <text class="item-value">1.0.0</text>
      </view>

      <view class="settings-item" bindtap="showPrivacy">
        <view class="item-left">
          <text class="item-title">隐私政策</text>
        </view>
        <text class="item-arrow">&#8250;</text>
      </view>

      <view class="settings-item" bindtap="showAbout">
        <view class="item-left">
          <text class="item-title">关于我们</text>
        </view>
        <text class="item-arrow">&#8250;</text>
      </view>
    </view>

    <!-- 危险区域 -->
    <view class="settings-section danger">
      <view class="section-header">
        <text class="section-icon">&#9888;</text>
        <text class="section-title">危险操作</text>
      </view>

      <view class="settings-item" bindtap="clearAllData">
        <view class="item-left">
          <text class="item-title danger-text">清除所有数据</text>
          <text class="item-desc">删除所有密码并重置应用</text>
        </view>
        <text class="item-arrow">&#8250;</text>
      </view>
    </view>

    <!-- 锁定按钮 -->
    <view class="lock-section">
      <button class="btn-lock" bindtap="lockVault">
        &#128274; 锁定保险箱
      </button>
    </view>
  </scroll-view>

  <!-- 修改密码弹窗 -->
  <view class="modal" wx:if="{{showChangePassword}}">
    <view class="modal-mask" bindtap="closeChangePassword"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">修改主密码</text>
        <text class="modal-close" bindtap="closeChangePassword">&#10005;</text>
      </view>

      <view class="modal-body">
        <view class="input-group">
          <view class="input-label">当前密码</view>
          <input
            class="input-field"
            type="password"
            placeholder="请输入当前主密码"
            value="{{currentPassword}}"
            bindinput="onCurrentPasswordInput"
          />
        </view>

        <view class="input-group">
          <view class="input-label">新密码</view>
          <input
            class="input-field"
            type="password"
            placeholder="请输入新密码（至少8位）"
            value="{{newPassword}}"
            bindinput="onNewPasswordInput"
          />
        </view>

        <view class="input-group">
          <view class="input-label">确认新密码</view>
          <input
            class="input-field"
            type="password"
            placeholder="请再次输入新密码"
            value="{{confirmNewPassword}}"
            bindinput="onConfirmNewPasswordInput"
          />
        </view>
      </view>

      <view class="modal-footer">
        <button class="btn-cancel" bindtap="closeChangePassword">取消</button>
        <button class="btn-confirm" bindtap="confirmChangePassword">确认修改</button>
      </view>
    </view>
  </view>
</view>
